<!DOCTYPE html>
<html lang="en">

<head>
  <title>osmos::feed</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="noindex, nofollow" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
  <link rel="alternate" type="application/rss+xml" title="osmos::feed" href="feed.atom" />
  <link href="index.css" rel="stylesheet" />
  <!-- %before-head-end.html% -->
</head>

<body>
<!-- %after-body-begin.html% -->
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-19">2021-06-19</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Changes in pdo_sqlite and var_dump in PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114976">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Sergei Morozov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Changes in pdo_sqlite and var_dump in PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114975">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Changes in pdo_sqlite and var_dump in PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114974">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Sergei Morozov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114973">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114972">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114971">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114970">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Hamza Ahmad</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114969">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Patrick ALLAERT</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-18">2021-06-18</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114968">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Benjamin Eberlei</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114967">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Rowan Tommins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114966">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Derick Rethans</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114965">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Rowan Tommins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114964">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Joe Watkins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114963">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Joe Watkins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114962">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Simple support question, about object equality</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114961">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Pierre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Simple support question, about object equality</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114960">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Simple support question, about object equality</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114959">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(0 min)</span>
                    <span>Pierre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Simple support question, about object equality</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114958">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Pierre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC][DISCUSSION] Match expression v2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114957">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Guilliam Xavier</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114956">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Bruce Weirdan</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Checking that Closure is static</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114955">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Дмитрий Елисеев</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114954">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Dik Takken</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC][DISCUSSION] Match expression v2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114953">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114952">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114951">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114950">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="https://www.stitcher.io/rss">stitcher.io</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">What about config builders?</summary>
                <a class="article-summary-link article-summary-box-outer" href="https://stitcher.io/blog/what-about-config-builders">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(4 min)</span>
                    <span>I&#x27;ve been tinkering with a hobby project lately: a small framework to get more familiar with PHP 8, and try out some random ideas floating in my head. It&#x27;s nothing too serious, but it&#x27;s a fun exercise.
Most of these ideas are born from my daily experience with Laravel, and more specifically from the little annoyances I have with it. Now, don&#x27;t get me wrong: I think Laravel is one of the best frameworks out there when it comes to modern PHP development and it&#x27;s only natural that it has a quirk here and there, after a decade of development.
So this definitely isn&#x27;t a Laravel-rant, rather it&#x27;s just a thought experiment in dealing with one of those little annoyances.

    


So, Laravel has these PHP config files, right. Here&#x27;s one example (this one is auth.php, if you&#x27;re wondering):
&lt;?php

return [

    /*
    |--------------------------------------------------------------------------
    | Authentication Defaults
    |--------------------------------------------------------------------------
    |
    | This option controls the default authentication &quot;guard&quot; and password
    | reset options for your application. You may change these defaults
    | as required, but they&#x27;re a perfect start for most applications.
    |
    */

    &#x27;defaults&#x27; &#x3D;&gt; [
        &#x27;guard&#x27; &#x3D;&gt; &#x27;web&#x27;,
        &#x27;passwords&#x27; &#x3D;&gt; &#x27;users&#x27;,
    ],

    /*
    |--------------------------------------------------------------------------
    | Authentication Guards
    |--------------------------------------------------------------------------
    |
    | Next, you may define every authentication guard for your application.
    | Of course, a great default configuration has been defined for you
    | here which uses session storage and the Eloquent user provider.
    |
    | All authentication drivers have a user provider. This defines how the
    | users are actually retrieved out of your database or other storage
    | mechanisms used by this application to persist your user&#x27;s data.
    |
    | Supported: &quot;session&quot;, &quot;token&quot;
    |
    */

    &#x27;guards&#x27; &#x3D;&gt; [
        &#x27;web&#x27; &#x3D;&gt; [
            &#x27;driver&#x27; &#x3D;&gt; &#x27;session&#x27;,
            &#x27;provider&#x27; &#x3D;&gt; &#x27;users&#x27;,
        ],

        &#x27;api&#x27; &#x3D;&gt; [
            &#x27;driver&#x27; &#x3D;&gt; &#x27;token&#x27;,
            &#x27;provider&#x27; &#x3D;&gt; &#x27;users&#x27;,
            &#x27;hash&#x27; &#x3D;&gt; false,
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | User Providers
    |--------------------------------------------------------------------------
    |
    | All authentication drivers have a user provider. This defines how the
    | users are actually retrieved out of your database or other storage
    | mechanisms used by this application to persist your user&#x27;s data.
    |
    | If you have multiple user tables or models you may configure multiple
    | sources which represent each model / table. These sources may then
    | be assigned to any extra authentication guards you have defined.
    |
    | Supported: &quot;database&quot;, &quot;eloquent&quot;
    |
    */

    &#x27;providers&#x27; &#x3D;&gt; [
        &#x27;users&#x27; &#x3D;&gt; [
            &#x27;driver&#x27; &#x3D;&gt; &#x27;eloquent&#x27;,
            &#x27;model&#x27; &#x3D;&gt; App\Models\User::class,
        ],

        // &#x27;users&#x27; &#x3D;&gt; [
        //     &#x27;driver&#x27; &#x3D;&gt; &#x27;database&#x27;,
        //     &#x27;table&#x27; &#x3D;&gt; &#x27;users&#x27;,
        // ],
    ],

    /*
    |--------------------------------------------------------------------------
    | Resetting Passwords
    |--------------------------------------------------------------------------
    |
    | You may specify multiple password reset configurations if you have more
    | than one user table or model in the application and you want to have
    | separate password reset settings based on the specific user types.
    |
    | The expire time is the number of minutes that the reset token should be
    | considered valid. This security feature keeps tokens short-lived so
    | they have less time to be guessed. You may change this as needed.
    |
    */

    &#x27;passwords&#x27; &#x3D;&gt; [
        &#x27;users&#x27; &#x3D;&gt; [
            &#x27;provider&#x27; &#x3D;&gt; &#x27;users&#x27;,
            &#x27;table&#x27; &#x3D;&gt; &#x27;password_resets&#x27;,
            &#x27;expire&#x27; &#x3D;&gt; 60,
            &#x27;throttle&#x27; &#x3D;&gt; 60,
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | Password Confirmation Timeout
    |--------------------------------------------------------------------------
    |
    | Here you may define the amount of seconds before a password confirmation
    | times out and the user is prompted to re-enter their password via the
    | confirmation screen. By default, the timeout lasts for three hours.
    |
    */

    &#x27;password_timeout&#x27; &#x3D;&gt; 10800,

];
While I think PHP configuration files are far superior to, for example, YAML or XML configuration; there&#x27;s one thing that annoys me quite a lot with it: there are no IDE insights in what kind of config values are available in this array, let alone which type of values they require.
To counteract this problem, the official Laravel config files have these inline doc blocks explaining each config entry. Most serious third party packages also provide such doc blocks.
With PHP 8 and named arguments though, there&#x27;s a better solution available: config objects that know exactly what kind of data they&#x27;d need.
Here&#x27;s what I&#x27;d imagine the auth.php would look like with it:
return AuthConfig::make()
    -&gt;defaults(
        guard: &#x27;web&#x27;,
        passwords: &#x27;users&#x27;,
    )
    -&gt;guards(
        web: GuardConfig::make()
            -&gt;driver(&#x27;session&#x27;)
            -&gt;provider(&#x27;users&#x27;),
        api: GuardConfig::make()
            -&gt;driver(&#x27;token&#x27;)
            -&gt;provider(&#x27;users&#x27;)
            -&gt;hash(false),
    )
    -&gt;providers(
        users: AuthProviderConfig::make()
            -&gt;driver(&#x27;eloquent&#x27;)
            -&gt;model(User::class),
    )
    -&gt;passwords(
        users: PasswordConfig::make()
            -&gt;provider(&#x27;users&#x27;)
            -&gt;table(&#x27;password_resets&#x27;)
            -&gt;expire(60)
            -&gt;throttle(60)
    )
    -&gt;passwordTimeout(10800);
Thanks to named arguments and their support for variadic functions, we end up with a conciser syntax, while still having all documentation available to us: it&#x27;s added as property types and doc blocks in these config objects, instead of being hard coded in the config files as text.
To me that&#x27;s the most important value: your IDE tells you what you need to do, instead of having to read documentation — inline or external:

The only thing needed for this to work is some kind of interface that requires these config builders, as I like to call them, to implement a toArray method. You could go one step further and turn things around by always using config objects instead of arrays, which would allow you to also make use of their built-in documentation when reading config, and not only when initializing it. That&#x27;s a bit more of a aggressive change though.
Here&#x27;s what a config builder implementation would look like:
class AuthConfig extends ConfigBuilder
{
    public function defaults(
        ?string $guard &#x3D; null,
        ?string $password &#x3D; null,
        // …
    ): self {
        $this-&gt;config[&#x27;defaults&#x27;][&#x27;guard&#x27;] &#x3D; 
            $guard 
            ?? $this-&gt;config[&#x27;defaults&#x27;][&#x27;guard&#x27;] 
            ?? null;
            
        $this-&gt;config[&#x27;defaults&#x27;][&#x27;password&#x27;] &#x3D; 
            $password 
            ?? $this-&gt;config[&#x27;defaults&#x27;][&#x27;password&#x27;] 
            ?? null;

        return $this;
    }

    public function guards(GuardConfig ...$guardConfigs): self
    {
        foreach ($guardConfigs as $name &#x3D;&gt; $guardConfig) {
            $this-&gt;config[&#x27;guards&#x27;][$name] &#x3D; $guardConfig-&gt;toArray();
        }

        return $this;
    }

    // …

    public function passwordTimeout(int $timeout): self
    {
        $this-&gt;config[&#x27;password_timeout&#x27;] &#x3D; $timeout;
        
        return $this;
    }
}
Another improvement I can come up with is by using enums instead of string values. They will be natively available in PHP 8.1, but there are also alternatives out there for older PHP versions.
Let&#x27;s just assume we&#x27;re already running PHP 8.1, we could write parts of it like so:
-&gt;guards(
    web: GuardConfig::make()
        -&gt;driver(Driver::Session)
        -&gt;provider(Provider::Users),
    api: GuardConfig::make()
        -&gt;driver(Driver::Token)
        -&gt;provider(Provider::Users)
        -&gt;hash(false),
)
These ideas aren&#x27;t new, by the way. We&#x27;ve been using config objects in some of our packages at Spatie, but we always start from a simple array and convert it when booting the application. There&#x27;s also PHP CS that uses the same approach. Also, Symfony just recently added support for a fluent interface to build their config files; great!

    Noticed a tpyo? You can submit a
    PR to fix it.

    If you want to stay up to date about what&#x27;s happening on this blog, you can follow me
    on Twitter or subscribe to my newsletter:

    
        Email
        
        Subscribe
    


There&#x27;s one advantage to tinkering with your own framework: you&#x27;re not constrained by backwards compatibility and legacy. I imagine it might not be trivial to properly support config builders in Laravel, at least not as the default approach. They also become much less useful if you cannot use named arguments, which require PHP 8.
But, who knows? Maybe something similar might get added in the future in Laravel? Or maybe some third-party packages start doing it on their own first. Anyway, I&#x27;m going to tinker some more with my custom framework, just for fun!

    
0
    
What&#x27;s your opinion on config builders? Let me know your thoughts, via Twitter or by subscribing to my newsletter.</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-17">2021-06-17</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">PHP 8.0.8RC1 Available for testing</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114936">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Gabriel Caruso</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC][DISCUSSION] Match expression v2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114935">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Mark Tomlin</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] Pure intersection types</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114934">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>G. P. B.</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allowsany key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114933">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114932">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114931">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Côme Chilliet</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114930">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:__[VOTE]_ImmutableIterable_(immutable,_rewindable,_allows_any_key&amp;repeating_keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114929">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114928">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114927">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114926">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114925">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114924">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Alexandru_Pătrănescu</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114923">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Côme Chilliet</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114922">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Dik Takken</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114921">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114920">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Nicolas Grekas</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114919">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Alexandru_Pătrănescu</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114918">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Côme Chilliet</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114917">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Côme Chilliet</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-16">2021-06-16</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114913">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114912">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Bruce Weirdan</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114911">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114910">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Dik Takken</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re: [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114909">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allowsany key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114908">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Levi Morrison via internals</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">[Vote] Partial Function Application</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114907">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allowsany key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114906">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114905">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114904">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allowsany key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114903">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114902">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114901">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114900">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-15">2021-06-15</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allows any key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114899">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Derick Rethans</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allowsany key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114898">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allowsany key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114897">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC][Draft] Add json_encode indent parameter</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114896">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Jakub Zelenka</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Rename Fiber::this() to Fiber::getCurrent()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114895">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Joe Watkins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Rename Fiber::this() to Fiber::getCurrent()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114894">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Rename Fiber::this() to Fiber::getCurrent()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114893">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Aaron Piotrowski</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [Vote] Short functions</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114892">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114891">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114890">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114889">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Côme Chilliet</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] ImmutableIterable (immutable, rewindable, allowsany key&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114888">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Marco Pivetta</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">[VOTE] ImmutableIterable (immutable, rewindable, allows anykey&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114887">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114886">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Hans Henrik Bergan</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114885">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re: [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114884">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114883">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Hans Henrik Bergan</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114882">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Rowan Tommins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Deprecations for PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114881">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Christoph M. Becker</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114880">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Joe Watkins</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="https://www.stitcher.io/rss">stitcher.io</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">A new major version of Laravel Event Sourcing</summary>
                <a class="article-summary-link article-summary-box-outer" href="https://stitcher.io/blog/a-new-major-version-of-laravel-event-sourcing">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Today, we released a new version of spatie/laravel-event-sourcing, version 5 is probably one of the largest releases since the beginning of the package, we&#x27;ve worked several months on it and have been testing it extensively already in our own projects.
Credit where credit is due, many new features were inspired by Axon,
In this post, I&#x27;ll walk you through all significant changes, but first I want to mention the course that we&#x27;ve built at Spatie over the last months about event sourcing. If you&#x27;re working on an event sourced project or thinking about starting one, this course will be of great help. Check it out on https://event-sourcing-laravel.com/!

    
0
    
# Consistent event handling
If you&#x27;ve used previous versions of our package, you might have struggled with how event handlers were registered across classes. Aggregate roots required you to write applyEventName functions, while projectors and reactors had an explicit event mapping.
Whatever class your writing will now register event handlers the same way: by looking at the type of the event. You don&#x27;t need any more configuration or naming conventions anymore.
class CartAggregateRoot extends AggregateRoot
{
    // …
    
    public function onCartAdded(CartAdded $event): void
    {
        // Any &#x60;CartAdded&#x60; event will automatically be matched to this handler
    }
}
class CartProjector extends Projector
{
    public function onCartAdded(CartAdded $event): void
    {
        // The same goes for projectors and reactors.
    }
}
# Event Queries
Event queries are a new feature that allow you to easily query an event stream without building database projections. You can think of them as in-memory projections that are rebuilt every time you call them.
Here&#x27;s an example of it in action:
class EarningsForProductAndPeriod extends EventQuery
{
    private int $totalPrice &#x3D; 0;
    
    public function __construct(
        private Period $period,
        private Collection $products
    ) {
        EloquentStoredEvent::query()
            -&gt;whereEvent(OrderCreated::class)
            -&gt;whereDate(&#x27;created_at&#x27;, &#x27;&gt;&#x3D;&#x27;, $this-&gt;period-&gt;getStart())
            -&gt;whereDate(&#x27;created_at&#x27;, &#x27;&lt;&#x3D;&#x27;, $this-&gt;period-&gt;getEnd())
            -&gt;cursor()
            -&gt;each(
                fn (EloquentStoredEvent $event) &#x3D;&gt; $this-&gt;apply($event)
            );
    }

    protected function applyOrderCreated(OrderCreated $orderCreated): void 
    {
        $orderLines &#x3D; collect($orderCreated-&gt;orderData-&gt;orderLineData);

        $totalPriceForOrder &#x3D; $orderLines
            -&gt;filter(function (OrderLineData $orderLineData) {
                return $this-&gt;products-&gt;first(
                    fn(Product $product) &#x3D;&gt; $orderLineData-&gt;productEquals($product)
                ) !&#x3D;&#x3D; null;
            })
            -&gt;sum(
                fn(OrderLineData $orderLineData) &#x3D;&gt; $orderLineData-&gt;totalPriceIncludingVat
            );

        $this-&gt;totalPrice +&#x3D; $totalPriceForOrder;
    }
}
Note that these examples come from the Event Sourcing in Laravel book.
# Aggregate Partials
Aggregate partials allow you to split large aggregate roots into separate classes, while still keeping everything contained within the same aggregate. Partials can record and apply events just like an aggregate root, and can share state between them and their associated aggregate root.
Here&#x27;s an example of an aggregate partial that handles everything related to item management within a shopping cart:
class CartItems extends AggregatePartial
{
    // …
    
    public function addItem(
        string $cartItemUuid, 
        Product $product, 
        int $amount
    ): self {
        $this-&gt;recordThat(new CartItemAdded(
            cartItemUuid: $cartItemUuid,
            productUuid: $product-&gt;uuid,
            amount: $amount,
        ));

        return $this;
    }

    protected function applyCartItemAdded(
        CartItemAdded $cartItemAdded
    ): void {
        $this-&gt;cartItems[$cartItemAdded-&gt;cartItemUuid] &#x3D; null;
    }
}
And this is how the cart aggregate root would use it:
class CartAggregateRoot extends AggregateRoot
{
    protected CartItems $cartItems;

    public function __construct()
    {
        $this-&gt;cartItems &#x3D; new CartItems($this);
    }

    public function addItem(
        string $cartItemUuid,
        Product $product,
        int $amount
    ): self {
        if (! $this-&gt;state-&gt;changesAllowed()) {
            throw new CartCannotBeChanged();
        }

        $this-&gt;cartItems-&gt;addItem($cartItemUuid, $product, $amount);

        return $this;
    }
Aggregate partials come with the same testing capabilities as aggregate roots, and are a useful way of keeping aggregate-related code maintainable.
# Command bus
We&#x27;ve added a command bus that can automatically map commands to handlers on aggregate roots:
namespace Spatie\Shop\Cart\Commands;

use Spatie\Shop\Support\EventSourcing\Attributes\AggregateUuid;
use Spatie\Shop\Support\EventSourcing\Attributes\HandledBy;
use Spatie\Shop\Support\EventSourcing\Commands\Command;

#[HandledBy(CartAggregateRoot::class)]
class AddCartItem implements Command
{
    public function __construct(
        #[AggregateUuid] public string $cartUuid,
        public string $cartItemUuid,
        public Product $product,
        public int $amount,
    ) {
    }
}
Whenever this command is dispatched, it will automatically be captured and handled by the associated aggregate root. It even works with aggregate partials:
class CartItems extends AggregatePartial
{
    // …
    
    public function addItem(AddCartItem $addCartItem): self
    {
        // …
    }
    
    public function removeItem(RemoveCartItem $removeCartItem): self
    {
        // …
    }
}    
Besides these new features, there are also some quality-of-life changes across the board:
The minimum required PHP version is now 8.0
The minimum required Laravel version is now 8.0
There&#x27;s better support for handling concurrency within the same aggregate root instance
There&#x27;s a way to fake reactors and projectors

There&#x27;s an improved event query builder

And more



All in all, I&#x27;m very exited for this new release. All the new features are also used in our real-life projects, so we know from experience how useful they are in complex applications. Of course, a blog post can&#x27;t discuss all the details and the thought process behind this new version, so make sure to read the book if you want in-depth knowledge about all of these features, and more.

    Noticed a tpyo? You can submit a
    PR to fix it.

    If you want to stay up to date about what&#x27;s happening on this blog, you can follow me
    on Twitter or subscribe to my newsletter:

    
        Email
        
        Subscribe</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-14">2021-06-14</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Allow objects in define()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114873">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Paul Dragoonis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114872">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(0 min)</span>
                    <span>Claude Pache</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114871">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Matthew Brown</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114870">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Allow objects in define()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114869">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114868">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Rowan Tommins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Allow objects in define()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114867">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(0 min)</span>
                    <span>Marco Pivetta</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114866">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Allow objects in define()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114865">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Allow objects in define()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114864">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Marco Pivetta</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Allow objects in define()</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114863">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Nikita Popov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114862">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114861">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Marco Pivetta</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114860">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Thomas Nunninger</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114859">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Matthew Brown</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114858">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Dan Ackroyd</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114857">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Dik Takken</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114856">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114855">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] Under Discussion: Add Random class andRandomNumberGenerator interface</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114854">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Guilliam Xavier</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114850">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(7 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114849">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-13">2021-06-13</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114848">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Matthew Brown</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114847">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114846">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>someniatko</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] make Reflection*#setAccessible() no-op</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114845">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] make Reflection*#setAccessible() no-op</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114844">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Marco Pivetta</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] make Reflection*#setAccessible() no-op</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114843">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114842">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(4 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">[RFC] make Reflection*#setAccessible() no-op</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114841">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Marco Pivetta</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114840">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(3 min)</span>
                    <span>Mike Schinkel</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-12">2021-06-12</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114839">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Lauri_Kenttä</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114838">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114837">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(0 min)</span>
                    <span>Lauri_Kenttä</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114836">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Joe Watkins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">[RFC] is_literal</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114835">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Craig Francis</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: RFC: CachedIterable (rewindable, allows anykey&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114834">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: [RFC] Under Discussion: Add Random class andRandomNumberGenerator interface</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114833">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(4 min)</span>
                    <span>Go Kudo</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-11">2021-06-11</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Zend Engine License in PHP source code</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114832">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Patrick ALLAERT</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] New in initializers</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114831">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Partial Function Application, take 2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114830">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>Joe Watkins</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] Deprecate autovivification on false</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114829">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Kamil Tekiela</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Partial Function Application, take 2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114828">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Guilliam Xavier</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] Deprecate autovivification on false</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114827">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Dmitry Stogov</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] Deprecate autovivification on false</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114826">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Claude Pache</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [VOTE] Deprecate autovivification on false</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114825">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Dmitry Stogov</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-10">2021-06-10</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="http://news-web.php.net/group.php?group&#x3D;php.internals">news-web.php.net: php.internals</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Partial Function Application, take 2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114824">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Jordi Boggiano</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Partial Function Application, take 2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114823">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Guilliam Xavier</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Partial Function Application, take 2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114822">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Dan Ackroyd</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Partial Function Application, take 2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114821">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Guilliam Xavier</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re: PHP 8.0.0alpha1 is available for testing</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114820">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(0 min)</span>
                    <span>Ben Ramsey</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: RFC: CachedIterable (rewindable, allows anykey&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114819">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Levi Morrison via internals</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  PHP 8.0.0alpha1 is available for testing</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114818">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Patrick ALLAERT</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: Allow combining arg unpacking and named args</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114817">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Levi Morrison via internals</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">PHP 8.0.0alpha1 is available for testing</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114816">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Ben Ramsey</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: Allow combining arg unpacking and named args</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114815">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: RFC: CachedIterable (rewindable, allows anykey&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114814">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Pierre</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  [RFC] Partial Function Application, take 2</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114813">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(1 min)</span>
                    <span>Larry Garfield</span>
                  </div>
                </a>
              </details>
            </article>
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Re:  Re: RFC: CachedIterable (rewindable, allows anykey&amp;repeating keys)</summary>
                <a class="article-summary-link article-summary-box-outer" href="http://news-web.php.net/php.internals/114812">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(2 min)</span>
                    <span>tyson andre</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-03">2021-06-03</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="https://www.stitcher.io/rss">stitcher.io</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">Why we need multi-line short closures in PHP</summary>
                <a class="article-summary-link article-summary-box-outer" href="https://stitcher.io/blog/why-we-need-multi-line-short-closures-in-php">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(5 min)</span>
                    <span>PHP 8.1 is already taking shape quite well, yet there&#x27;s one feature I&#x27;d love to see added, that&#x27;s still being discussed: multi-line short closures. The RFC calls them &quot;Auto-capturing multi-statement closures&quot; but I hope you don&#x27;t mind me using the somewhat shorter name.
If you&#x27;re on an actively supported PHP version, you already know about short closures — a.k.a. &quot;arrow functions&quot;. And, most importantly, one of their biggest drawbacks: they only support one-line expressions, which are also used as the return value.
The multi-line short closures RFC by Nuno and Larry aims to solve that problem, in — what I think is — an elegant way.
Some people are skeptical about this RFC though, and I want to address their arguments and share why I think it&#x27;s still a worthwhile addition. Though first, I&#x27;ll show you what the RFC is about. Keep in mind this is a proposal, and not added to PHP yet!

    


A quick refresher, this is what arrow functions in PHP look like today:
$getTitle &#x3D; fn (Post $post) &#x3D;&gt; $post-&gt;title;
And this is what the RFC proposes:
$date &#x3D; now();

$getSlug &#x3D; fn (Post $post) {
    $slug &#x3D; Str::slug($post-&gt;title);
    
    return $date . $slug;
}
There are two important things to note about multi-line short closures:
they have access to the variables in the upper scope without needing use; and
they don&#x27;t automatically return the last expression, which makes sense since there can be several expressions in a multi-line closure.
You might have already noticed it, but the RFC introduces an elegant kind of symmetry in how you can create closures:
on the one hand there&#x27;s function and fn, the first one doesn&#x27;t auto-capture variables from the outside, the second one does; and
on the other hand there&#x27;s { … } or &#x3D;&gt;, using curly brackets allow you to write multiple lines, while &#x3D;&gt; only accepts one expression, but also returns it.
Because of this symmetry, all of the following code samples are possible and all of them behaving a little differently.
Here&#x27;s a closure that doesn&#x27;t auto-capture outer scope, with multiple lines:
$date &#x3D; now();

$getSlug &#x3D; function (Post $post) use ($date) {
    $slug &#x3D; Str::slug($post-&gt;title);
    
    return $date . $slug;
}
Next, a closure that does capture outer scope and immediately returns the result:
$date &#x3D; now();

$getSlug &#x3D; fn (Post $post) &#x3D;&gt; $date . Str::slug($post-&gt;title);
And finally — proposed by the RFC — a closure that does capture outer scope, but still allows multiple lines:
$date &#x3D; now();

$getSlug &#x3D; fn (Post $post) {
    $slug &#x3D; Str::slug($post-&gt;title);
    
    return $date . $slug;
}
If you&#x27;re counting, you know that one option is still missing: a closure that doesn&#x27;t auto-capture outer scope and immediately returns a value:
$date &#x3D; now();

$getSlug &#x3D; function (Post $post) use ($date) 
    &#x3D;&gt; $date . Str::slug($post-&gt;title);
The RFC lists this last one as a possible future addition, but doesn&#x27;t cover it right now.
With the background info out of the way, let&#x27;s look at some counter arguments as to why some people don&#x27;t like this change.
# Auto-capturing outer scope can lead to bugs
Some people voice their fear about auto-capturing variables from the outer scope, especially that it can lead to unclear code in the long run and thus, bugs.
I&#x27;ve got a few arguments against that fear.
First, auto-capturing is already supported by PHP in the current short closures, there&#x27;s nothing about this RFC that changes that. The arrow function RFC passed with 51 votes for, and 8 against after a thorough discussion, and has been used extensively in lots of projects since — take a look at some popular OSS frameworks if you want some examples. Clear signs that this particular behaviour is wanted by the majority of people, whether you&#x27;re afraid of it or not.
Nikita also shares this opinion:
I&#x27;m generally in favor of supporting auto-capture for multi-line closures. I think that extensive experience in other programming languages has shown that auto-capture does not hinder readability of code, and I don&#x27;t see any particular reason why the effects in PHP would be different. — https://externals.io/message/113740#114239
Auto-capturing outer scope might not be your preferred way of coding, but that doesn&#x27;t mean the idea should be dismissed, as there are many people who do prefer this style.
Fear should never be the driving force in a programming language&#x27;s design, we should look at facts instead.

    Noticed a tpyo? You can submit a
    PR to fix it.

    If you want to stay up to date about what&#x27;s happening on this blog, you can follow me
    on Twitter or subscribe to my newsletter:

    
        Email
        
        Subscribe
    


# By-value or by-reference passing
I believe the RFC gets it right when it says that outer-scope variables are always captured by-value, and not by-reference. This means that you won&#x27;t be able to change the value of an outer-scope variable from within your closure — a good thing.
People might argue that this will cause confusion, because what happens if you do want to change the outer-scope variable? We could discuss about whether this would ever be a good idea or not, but it doesn&#x27;t even matter since PHP already has the answer — remember that symmetry I talked about earlier?
If you want by-reference passing, you&#x27;ll need to specifically say which variables you want access to — which is exactly what function allows:
$date &#x3D; now();

$getSlug &#x3D; function (Post $post) use (&amp;$date) {
    $date &#x3D; now()-&gt;addDay();
    
    // Please don&#x27;t do this…
}
I&#x27;d argue that this RFC creates clear boundaries between what&#x27;s possible with function and fn. It doesn&#x27;t cause confusion; on the contrary: it creates consistency and clarity within PHP&#x27;s syntax.
# There&#x27;s little space to be gained
Some people argue that there&#x27;s no need for adding multi-line short closures because there&#x27;s little to be gained when it comes to the amount of characters you&#x27;re writing. That might be true if you&#x27;re not relying on outer-scope values, but to be honest it&#x27;s not about how many characters you write.
This RFC makes the language&#x27;s syntax more consistent, and a consistent language allows for easier programming.
When writing code, I don&#x27;t want to be bothered with having to change fn to function when refactoring a closure that suddenly does need to be written on two lines instead of the prior one.
It might seem like such a small detail, but it&#x27;s those details that impact our day-by-day developer life. And isn&#x27;t that what a maturing language should be about? Look at features like property promotion, named arguments, enums, attributes, the match operator, etc. You could argue that none of those feature are &quot;necessary&quot; to write working PHP code, but still they do improve my day-by-day life significantly — and I hope yours too.
# Holding on to the past
Finally, some people might find it difficult to deal with change, and you really need to ask yourself that question if you&#x27;re voting on RFCs. Yes, you might not see a need for a given feature but you&#x27;re not only voting for yourself, you have a responsibility to the PHP community; there&#x27;s more to this than just your projects and your team.
Do you know why closures right now don&#x27;t auto-import variables from the outer scope? You might have gotten used to it, but do you know why they were designed this way 12 years ago? Larry did some digging in the mailing list archives, and discovered there were three reasons why use was introduced in the first place:
there were performance concerns if variables of the outer-scope were auto-captured — concerns that are no longer relevant today;
it was used to avoid surprise by-reference value passing — which also isn&#x27;t a problem since we&#x27;re always using by-value passing; and
it allowed users to explicitly capture variables by-value or by-reference, which is now cleanly solved because of the distinction between function and fn.
You might have gotten used to closures not auto-importing variables for the past decade, but keep in mind this behaviour was only added as a necessity back in the day. All arguments for only using explicit capture have been nullified by time, a great sign that PHP is maturing even more.

    Noticed a tpyo? You can submit a
    PR to fix it.

    If you want to stay up to date about what&#x27;s happening on this blog, you can follow me
    on Twitter or subscribe to my newsletter:

    
        Email
        
        Subscribe
    


With all of that being said, I&#x27;m looking forward to Nuno and Larry opening the vote on their RFC. PHP 8.1&#x27;s feature freeze is planned for the 20th of July, 2021; so there&#x27;s still some time to finalize the details. If you&#x27;re voting on RFCs, I truly hope you can see the big picture, as this is one of the RFCs that will have a significant impact on many people&#x27;s developer life.</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>
  <section class="daily-content">
    <h2 class="daily-heading"><time datatime="2021-06-01">2021-06-01</time></h2>
    <ul class="sources card">
      <li class="source">
        <section>
          <h3 class="source-name"><a class="source-name__link" href="https://www.stitcher.io/rss">stitcher.io</a></h3>
          <section class="articles-per-source">
            <article>
              <details class="article-expander">
                <summary class="article-expander__title">What&#x27;s new in PHP 8.1</summary>
                <a class="article-summary-link article-summary-box-outer" href="https://stitcher.io/blog/new-in-php-81">
                  <div class="article-summary-box-inner">
                    <span class="article-reading-time">(5 min)</span>
                    <span>PHP 8.1 is currently in active development and will be released on November 25, 2021. Keep in mind that this date can still change if the core team, for examples, adds an extra beta release. We already know about new features, performance improvements, changes and deprecations; so let&#x27;s go through them one by one.

    
Serverless Visually Explained by Matthieu Napoli and learn how to create scalable PHP applications on AWS.
    
# New features
As with every release, PHP 8.1 adds some nice new features. Keep in mind that this list will grow over the year.

    
0
    
# Enums RFC
Enums will be added in PHP 8.1! If you&#x27;re unsure what they can be used for, you can read about them here.
Adding enums would be a significant improvement in PHP, so I for one am very much looking forward seeing enums arrive in PHP 8.1. To give you a quick preview of what they will look like, here&#x27;s a code sample:
enum Status {
  case Pending;
  case Active;
  case Archived;
}
And this is how they will be used:
class Post
{
    public function __construct(
        private Status $status &#x3D; Status::Pending;
    ) {}

    public function setStatus(Status $status): void
    {
        // …
    }
}

$post-&gt;setStatus(Status::Active);
You can find an in-depth analysis of how to use enums in this post.

    



# Fibers RFC
Fibers — aka &quot;green threads&quot; — are a low level mechanism to manage parallelism. You probably won&#x27;t use them directly in your applications, but frameworks like Amphp and ReactPHP will make extensive use of them.
Here&#x27;s a simple example of using fibers:
$fiber &#x3D; new Fiber(function (): void {
    $valueAfterResuming &#x3D; Fiber::suspend(&#x27;after suspending&#x27;);
    
    // … 
});
 
$valueAfterSuspending &#x3D; $fiber-&gt;start();
 
$fiber-&gt;resume(&#x27;after resuming&#x27;);
If you want to read some more about fibers, what they can and can&#x27;t do, you can read this post.
# Performance improvements PR
Dmitry Stogov has added some improvements to opcache, he calls it &quot;inheritance cache&quot;. This feature allows links between classes to be cached, much like linked classes can be preloaded as of PHP 7.4.
Dmitry reports between a 5% and 8% performance increase thanks to this change, a nice little detail to look out for in PHP 8.1.
# Array unpacking with string keys RFC
Array unpacking was already allowed in PHP 7.4, but it only worked with numeric keys. The reason string keys weren&#x27;t supported before is because there wasn&#x27;t any consensus on how to merge array duplicates. The RFC cleanly solves this by following the semantics of array_merge:
$array1 &#x3D; [&quot;a&quot; &#x3D;&gt; 1];

$array2 &#x3D; [&quot;b&quot; &#x3D;&gt; 2];

$array &#x3D; [&quot;a&quot; &#x3D;&gt; 0, ...$array1, ...$array2];

var_dump($array); // [&quot;a&quot; &#x3D;&gt; 1, &quot;b&quot; &#x3D;&gt; 2]
# New never type RFC
The never type can be used to indicated that a function will actually stop the program flow. This can be done either by throwing an exception, calling exit or other similar functions.
function dd(mixed $input): never
{
    // dump
    
    exit;
}
never differs from void in that void still allows the program to continue. This might seem like a novelty feature but it&#x27;s actually a quite useful one for static analysers.
# New array_is_list function RFC
You&#x27;ve probably had to deal with this once in a while: determine if an array&#x27;s keys are in numerical order, starting from index 0. Just like json_encode decides whether an array should be encoded as an array or object.
PHP 8.1 adds a built-in function to determine whether an array is a list with those semantics, or not:
$list &#x3D; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];

array_is_list($list); // true

$notAList &#x3D; [1 &#x3D;&gt; &quot;a&quot;, 2 &#x3D;&gt; &quot;b&quot;, 3 &#x3D;&gt; &quot;c&quot;];

array_is_list($notAList); // false

$alsoNotAList &#x3D; [&quot;a&quot; &#x3D;&gt; &quot;a&quot;, &quot;b&quot; &#x3D;&gt; &quot;b&quot;, &quot;c&quot; &#x3D;&gt; &quot;c&quot;];

array_is_list($alsoNotAList); // false

    
Email
        
        Subscribe
    



# Final class constants RFC
Class constants in PHP can be overridden during inheritance:
class Foo
{
    public const X &#x3D; &quot;foo&quot;;
}
 
class Bar extends Foo
{
    public const X &#x3D; &quot;bar&quot;;
}
As of PHP 8.1, you can mark such constants as final in order to prevent this:
class Foo
{
    final public const X &#x3D; &quot;foo&quot;;
}
 
class Bar extends Foo
{
    public const X &#x3D; &quot;bar&quot;;
    Fatal error: Bar::X cannot override final constant Foo::X
}
# New fsync function RFC
PHP 8.1 adds the fsync and fdatasync functions to force synchronization of file changes to disk and ensure operating system write buffers have been flushed before returning.
$file &#x3D; fopen(&quot;sample.txt&quot;, &quot;w&quot;);

fwrite($file, &quot;Some content&quot;);

if (fsync($file)) {
    echo &quot;File has been successfully persisted to disk.&quot;;
}

fclose($file);
Because disk synchronization is a file system operation, the fsync function will only work on plain file streams. Attempting to sync non-file streams will emit a warning.
# Explicit octal integer literal notation RFC
You can now use 0o and 0O to denote octal numbers. The previous notation by prefixing a number with 0 still works as well.
016 &#x3D;&#x3D;&#x3D; 0o16; // true
016 &#x3D;&#x3D;&#x3D; 0O16; // true
# Breaking changes
While PHP 8.1 is a minor version, there will be some changes that might technically be a breaking change, and deprecations as well. Let&#x27;s discuss them one by one.
# Restrict $GLOBALS usage RFC
A small change to how $GLOBALS is used will have a significant impact on the performance of all array operations. Nikita does a fine job explaining the problem and solution in the RFC. The change means that some edge cases aren&#x27;t possible to do any more with $GLOBALS. &quot;What is no longer supported are writes to $GLOBALS taken as a whole. All the following will generate a compile-time error&quot;:
$GLOBALS &#x3D; [];
$GLOBALS +&#x3D; [];
$GLOBALS &#x3D;&amp; $x;
$x &#x3D;&amp; $GLOBALS;
unset($GLOBALS);
On top of that, passing $GLOBALS by reference will generate a runtime error:
by_ref($GLOBALS); // Run-time error
Nikita analysed the top 2000 packages on Packagist, and only found 23 cases that will be affected by this change. We can conclude the impact of this — technically breaking — change will be low, which is why internals decided to add it in PHP 8.1. Remember that most of us will win by this change, given the positive performance impact it has everywhere in our code.
# Resource to object migrations
These changes are part of the long-term vision to convert all resources to dedicated objects. You can read more about it here.
Fileinfo functions with finfo objects
Functions like finfo_file and finfo_open used to accept and return resources. As of PHP 8.1, they work with finfo objects.
IMAP functions with IMAPConnection objects
Just like the fileinfo change, IMAP functions like imap_body and imap_open no longer work with resources
# Deprecate passing null to non-nullable arguments of internal functions RFC
This change is simple: internal functions currently accept null for arguments that are non-nullable, this RFC deprecates that behaviour. For example, this is currently possible:
str_contains(&quot;string&quot;, null);
In PHP 8.1, these kinds of errors will throw a deprecation warning, in PHP 9 they will be converted to type errors.
# Other small changes
With every release, there&#x27;s a bunch of very minor changes to the language. All of them are listed in the UPGRADING guide on GitHub, make sure to check it out if you want to know every little detail.
Here&#x27;s a summary of the most significant changes:
MYSQLI_STMT_ATTR_UPDATE_MAX_LENGTH no longer has an effect
MYSQLI_STORE_RESULT_COPY_DATA no longer has an effect
PDO
::
ATTR_STRINGIFY_FETCHES
 now also works with booleans
Integers and floats in PDO MySQL and Sqlite result sets will be returned using native PHP types instead of strings when using emulated prepared statements
Functions like htmlspecialchars and htmlentities now also escape &#x27; by default to &amp;#039;; malformed UTF-8 will also be replaced with a unicode character, instead of resulting in an empty string
The hash, hash_file and hash_init have an extra argument added to them called $options, it has a default value of [] so it won&#x27;t affect your code
New support for MurmurHash3 and xxHash



That&#x27;s it for now, keep in mind I&#x27;ll regularly update this post during the year, so make sure to subscribe if you want to be kept in the loop. Are you excited for PHP 8.1? Let me know on Twitter!

    Noticed a tpyo? You can submit a
    PR to fix it.

    If you want to stay up to date about what&#x27;s happening on this blog, you can follow me
    on Twitter or subscribe to my newsletter:

    
        Email
        
        Subscribe</span>
                  </div>
                </a>
              </details>
            </article>
        </section>
      </li>
    </ul>
  </section>

  <footer>
    <time id="build-timestamp" datetime="2021-06-21T01:05:52.528Z">2021-06-21T01:05:52.528Z</time>
    <span><a class="footer-link" href="https://github.com/osmoscraft/osmosfeed">osmosfeed 1.10.2</a></span>
  </footer>
  <script src="index.js"></script>
  <!-- %before-body-end.html% -->
</body>

</html>